{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar __jsx = React.createElement;\nimport Head from 'next/head';\nimport AV from 'leancloud-storage';\nimport dynamic from 'next/dynamic';\nimport { Table, Tag, Space, Modal, Form, Input, Button, Checkbox, notification } from 'antd';\nimport React, { useState, useEffect } from 'react';\nimport styles from './index.module.scss';\nimport Layout from 'src/components/admin/Layout';\nimport TopicItem from 'src/components/admin/TopicItem';\nimport { createTopics, getTopicList, updateTopic } from 'src/service/topics';\n\nfunction AdminHome() {\n  var _useState = useState(false),\n      modalShow = _useState[0],\n      setmodalShow = _useState[1];\n\n  var _useState2 = useState(''),\n      title = _useState2[0],\n      settitle = _useState2[1];\n\n  var _useState3 = useState(''),\n      desc = _useState3[0],\n      setdesc = _useState3[1];\n\n  var _useState4 = useState([]),\n      list = _useState4[0],\n      setlist = _useState4[1];\n\n  var _useState5 = useState(1),\n      status = _useState5[0],\n      setstatus = _useState5[1];\n\n  var handleCreate = function handleCreate() {\n    return _regeneratorRuntime.async(function handleCreate$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(list.length > 20)) {\n              _context.next = 3;\n              break;\n            }\n\n            notification.error({\n              message: '话题不能超过20个' // description: \"请输入用户名、密码\",\n\n            });\n            return _context.abrupt(\"return\");\n\n          case 3:\n            if (title) {\n              _context.next = 6;\n              break;\n            }\n\n            notification.error({\n              message: '请输入标题' // description: \"请输入用户名、密码\",\n\n            });\n            return _context.abrupt(\"return\");\n\n          case 6:\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(createTopics({\n              title: title,\n              desc: desc\n            }));\n\n          case 8:\n            setmodalShow(false);\n            getlist({\n              status: status\n            });\n            notification.success({\n              message: '操作成功' // description: \"请输入用户名、密码\",\n\n            });\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var getlist = function getlist() {\n    var params,\n        res,\n        _args2 = arguments;\n    return _regeneratorRuntime.async(function getlist$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            params = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : {};\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(getTopicList(params));\n\n          case 3:\n            res = _context2.sent;\n            setlist(res);\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleNavChange = function handleNavChange(params) {\n    return _regeneratorRuntime.async(function handleNavChange$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            setstatus(params.status);\n\n          case 1:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    getlist({\n      status: status\n    });\n  }, [status]);\n  return __jsx(Layout, null, __jsx(\"p\", {\n    className: \"_admin_body_section_title\"\n  }, \"\\u8BDD\\u9898\\u8BBE\\u7F6E\"), __jsx(\"div\", {\n    className: styles.topics\n  }, __jsx(\"div\", {\n    className: \"_admin_body_section_block\"\n  }, __jsx(\"div\", {\n    className: \"_admin_body_section_block_nav\"\n  }, __jsx(\"span\", {\n    className: status === 1 ? '_admin_body_section_block_nav_item_active' : '_admin_body_section_block_nav_item',\n    onClick: function onClick() {\n      handleNavChange({\n        status: 1\n      });\n    }\n  }, \"\\u672A\\u4E0A\\u7EBF\"), __jsx(\"span\", {\n    className: status === 2 ? '_admin_body_section_block_nav_item_active' : '_admin_body_section_block_nav_item',\n    onClick: function onClick() {\n      handleNavChange({\n        status: 2\n      });\n    }\n  }, \"\\u5DF2\\u4E0A\\u7EBF\"))), list && list.length > 0 && __jsx(\"div\", {\n    className: \"_admin_body_section_block\",\n    style: {\n      padding: 30\n    }\n  }, __jsx(\"div\", {\n    className: styles.list\n  }, list.map(function (obj) {\n    return __jsx(TopicItem, {\n      key: obj.id,\n      item: obj,\n      onChange: function onChange() {\n        getlist({\n          status: status\n        });\n      }\n    });\n  }))), __jsx(Button, {\n    type: \"primary\",\n    size: \"large\",\n    onClick: function onClick() {\n      setmodalShow(true);\n    }\n  }, \"+ \\u65B0\\u5EFA\\u8BDD\\u9898\"), __jsx(Modal, {\n    title: \"\\u521B\\u5EFA\\u8BDD\\u9898\",\n    width: 500,\n    visible: modalShow,\n    onCancel: function onCancel() {\n      setmodalShow(false);\n    },\n    onOk: function onOk() {\n      handleCreate();\n    },\n    okText: \"\\u4FDD\\u5B58\",\n    cancelText: \"\\u53D6\\u6D88\"\n  }, __jsx(\"div\", null, __jsx(Form, {\n    labelCol: {\n      span: 5\n    },\n    wrapperCol: {\n      span: 19\n    },\n    name: \"basic\",\n    initialValues: {\n      remember: true\n    },\n    onFinish: function onFinish() {},\n    onFinishFailed: function onFinishFailed() {}\n  }, __jsx(Form.Item, {\n    label: \"\\u8BDD\\u9898\\u540D\\u79F0\",\n    name: \"title\",\n    rules: [{\n      required: true,\n      message: '请输入话题名称'\n    }]\n  }, __jsx(Input, {\n    value: title,\n    onChange: function onChange(e) {\n      settitle(e.target.value);\n    }\n  })), __jsx(Form.Item, {\n    label: \"\\u8BDD\\u9898\\u63CF\\u8FF0\",\n    name: \"desc\",\n    rules: [{\n      required: false,\n      message: '请输入话题描述'\n    }]\n  }, __jsx(Input, {\n    value: desc,\n    onChange: function onChange(e) {\n      setdesc(e.target.value);\n    }\n  })))))));\n}\n\nexport default AdminHome;","map":null,"metadata":{},"sourceType":"module"}