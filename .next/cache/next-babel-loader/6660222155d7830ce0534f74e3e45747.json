{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nvar __jsx = React.createElement;\nimport Head from \"next/head\";\nimport AV from \"leancloud-storage\";\nimport dynamic from \"next/dynamic\";\nimport { Table, Tag, Space, Switch, notification, Radio, Popover, Modal, Button } from \"antd\";\nimport { QuestionCircleOutlined } from \"@ant-design/icons\";\nimport React, { useState, useEffect } from \"react\";\nimport styles from \"./index.module.scss\";\nimport Layout from \"src/components/admin/Layout\";\nimport InputItem from \"src/components/admin/InputItem\";\nimport { createProfile, getProfileList, updateProfile } from \"src/service/profile\";\n\nfunction AdminHome(props) {\n  var _useState = useState(null),\n      curUserInfo = _useState[0],\n      setcurUserInfo = _useState[1];\n\n  var _useState2 = useState(null),\n      profile = _useState2[0],\n      setprofile = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      logo = _useState3[0],\n      setlogo = _useState3[1];\n\n  var _useState4 = useState(\"\"),\n      title = _useState4[0],\n      settitle = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      github = _useState5[0],\n      setgithub = _useState5[1];\n\n  var _useState6 = useState(\"\"),\n      email = _useState6[0],\n      setemail = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      social_link = _useState7[0],\n      setsocial_link = _useState7[1];\n\n  var _useState8 = useState(\"\"),\n      copyright = _useState8[0],\n      setcopyright = _useState8[1];\n\n  var _useState9 = useState(false),\n      allowAComment = _useState9[0],\n      setallowAComment = _useState9[1];\n\n  var _useState10 = useState(false),\n      allowBComment = _useState10[0],\n      setallowBComment = _useState10[1];\n\n  var _useState11 = useState(false),\n      allowRegister = _useState11[0],\n      setallowRegister = _useState11[1];\n\n  var _useState12 = useState(false),\n      showBlog = _useState12[0],\n      setshowBlog = _useState12[1];\n\n  var _useState13 = useState(\"\"),\n      blogName = _useState13[0],\n      setblogName = _useState13[1]; // 获取资料\n\n\n  var getProfile = function getProfile() {\n    getProfileList().then(function (res) {\n      if (res) {\n        setprofile(res);\n        setlogo(res.attributes.logo);\n        settitle(res.attributes.title);\n        setgithub(res.attributes.github);\n        setemail(res.attributes.email);\n        setsocial_link(res.attributes.social_link);\n        setcopyright(res.attributes.copyright);\n        setallowAComment(res.attributes.allowAComment);\n        setallowBComment(res.attributes.allowBComment);\n        setallowRegister(res.attributes.allowRegister);\n        setshowBlog(res.attributes.showBlog);\n        setblogName(res.attributes.blogName);\n      } else {\n        createProfile().then(function (resCreate) {\n          setprofile(resCreate);\n        });\n      }\n    });\n  }; // 更新profile\n\n\n  var handlesubmit = function handlesubmit() {\n    return _regeneratorRuntime.async(function handlesubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(updateProfile({\n              profileItem: profile,\n              params: {\n                logo: logo,\n                title: title,\n                github: github,\n                email: email,\n                social_link: social_link,\n                copyright: copyright,\n                allowAComment: allowAComment,\n                allowBComment: allowBComment,\n                allowRegister: allowRegister,\n                showBlog: showBlog,\n                blogName: blogName\n              }\n            }));\n\n          case 2:\n            getProfile();\n            notification.success({\n              message: \"更新成功\" // description: \"请输入用户名、密码\",\n\n            });\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    getProfile();\n  }, []);\n  return __jsx(Layout, {\n    onChange: function onChange(params) {\n      setcurUserInfo(params.userinfo);\n    }\n  }, __jsx(\"p\", {\n    className: \"_admin_body_section_title\"\n  }, \"\\u57FA\\u672C\\u8BBE\\u7F6E\"), curUserInfo && curUserInfo.toJSON().priority === 100 && profile ? __jsx(\"div\", {\n    className: styles.setting\n  }, __jsx(\"div\", {\n    className: \"_admin_body_section_block\",\n    style: {\n      padding: 30\n    }\n  }, __jsx(InputItem, {\n    title: \"Logo\",\n    type: \"image\",\n    value: logo,\n    onChange: function onChange(e) {\n      setlogo(e);\n    }\n  }), __jsx(InputItem, {\n    title: \"\\u6807\\u9898\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u6807\\u9898\",\n    value: title,\n    onChange: function onChange(e) {\n      settitle(e);\n    }\n  }), __jsx(InputItem, {\n    title: \"Github\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165url\",\n    value: github,\n    onChange: function onChange(e) {\n      setgithub(e);\n    }\n  }), __jsx(InputItem, {\n    title: \"Email\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165email\",\n    value: email,\n    onChange: function onChange(e) {\n      setemail(e);\n    }\n  }), __jsx(InputItem, {\n    title: \"\\u793E\\u4EA4\\u94FE\\u63A5\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165url\",\n    value: social_link,\n    onChange: function onChange(e) {\n      setsocial_link(e);\n    }\n  }), __jsx(InputItem, {\n    title: \"CopyRight\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165copyright\",\n    value: copyright,\n    onChange: function onChange(e) {\n      setcopyright(e);\n    }\n  })), __jsx(\"div\", {\n    className: \"_admin_body_section_block\",\n    style: {\n      padding: 30\n    }\n  }, __jsx(InputItem, {\n    type: \"switch\",\n    title: \"\\u5141\\u8BB8\\u65B0\\u7528\\u6237\\u6CE8\\u518C\",\n    value: allowRegister,\n    onChange: function onChange(e) {\n      setallowRegister(e);\n    }\n  })), __jsx(\"div\", {\n    className: \"_admin_body_section_block\",\n    style: {\n      padding: 30\n    }\n  }, __jsx(InputItem, {\n    type: \"switch\",\n    title: \"\\u5141\\u8BB8\\u8BC4\\u8BBA\\u6587\\u7AE0\",\n    value: allowAComment,\n    onChange: function onChange(e) {\n      setallowAComment(e);\n    }\n  })), __jsx(\"div\", {\n    className: \"_admin_body_section_block\",\n    style: {\n      padding: 30\n    }\n  }, __jsx(InputItem, {\n    type: \"switch\",\n    title: \"\\u5F00\\u653E\\u52A8\\u6001\\u6A21\\u5757\",\n    value: showBlog,\n    onChange: function onChange(e) {\n      setshowBlog(e);\n    }\n  }), __jsx(InputItem, {\n    type: \"switch\",\n    title: \"\\u5141\\u8BB8\\u8BC4\\u8BBA\\u52A8\\u6001\\u6A21\\u5757\",\n    value: allowBComment,\n    onChange: function onChange(e) {\n      setallowBComment(e);\n    }\n  }), __jsx(InputItem, {\n    title: \"\\u52A8\\u6001\\u6A21\\u5757\\u540D\\u79F0\",\n    placeholder: \"\\u8BF7\\u8F93\\u5165\",\n    value: blogName,\n    onChange: function onChange(e) {\n      setblogName(e);\n    }\n  })), __jsx(Button, {\n    type: \"primary\",\n    size: \"large\",\n    onClick: function onClick() {\n      handlesubmit();\n    }\n  }, \"\\u4FDD\\u5B58\")) : __jsx(\"div\", {\n    className: \"_admin_body_section_block\",\n    style: {\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      minHeight: 100\n    }\n  }, \"\\u6682\\u65E0\\u6743\\u9650\\uFF0C\\u8BF7\\u8054\\u7CFB\\u7BA1\\u7406\\u5458\\u5F00\\u901A\\uFF5E\"));\n}\n\nexport default AdminHome;","map":null,"metadata":{},"sourceType":"module"}